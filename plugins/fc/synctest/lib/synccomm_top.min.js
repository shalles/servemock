!function(a){function h(a){return"function"==typeof a}function i(a){this.list=[]}function j(a,b){return b.indexOf(a)>-1}function k(a,b){for(var c in b)if(j(a.ele,b[c].ele)&&j(a.type,b[c].type))return!0;return!1}function l(a,b){return a.target=b,a}function m(b){function d(b){if(!b)return c;if(b===a)c.push("window");else if(b===a.document)c.push("document");else if(b===document.body)c.push("body");else{if(b.id)return c.push("#"+b.id),c;b.classList&&b.classList.length?c.push("."+b.classList.toString().split(" ").join(".")):c.push(b.tagName),d(b.parentElement)}}var c=[];return d(b),c.reverse().join(">")}function n(a,b,c){var d,e;return b=b>c?b:c,function(){var f=this,g=new Date,h=arguments;clearTimeout(d),e||(e=g),g-e>=c?(a.apply(f,h),e=g):d=setTimeout(function(){a.apply(f,h)},b)}}function p(c){c=JSON.parse(c);var f,g,h={},i=c.selector;if(k({ele:i,type:c.type},e))return{};switch(f="window"===i?a:document.querySelector(i),g=b[f[d]][c.type],l(h,f),c.type){case"input":f.value=c.value;break;case"focus":f.focus();break;case"scroll":f.scrollTop?(f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft):a.scrollTo(c.scrollLeft,c.scrollTop);break;case"click":f.tagName&&"a"===f.tagName.toLowerCase()&&-1===f.href.indexOf("javascript")&&(location.href=f.href)}switch(f.tagName&&f.tagName.toLowerCase()){case"input":f.value=c.value}return{event:h,type:c.type,ele:f,listeners:g}}function q(a,b){var c=a,d=m(c),e={selector:d,type:b.type};switch(b.type){case"input":e.value=c.value;break;case"scroll":e.scrollTop=c.scrollTop||scrollY,e.scrollLeft=c.scrollLeft||scrollX}switch(c.tagName&&c.tagName.toLowerCase()){case"input":e.value=c.value}return console.log(e),JSON.stringify(e)}function r(a){""!==a&&1===g.readyState&&g.send(a)}function s(a){var b,c,d,e;(b=a.ele)&&(c="__synctest_event",d=new Event(c),e=function(b){b.preventDefault(),a.listeners&&a.listeners.fire(b)},t.call(b,c,e),b.dispatchEvent(d),b.removeEventListener(c,e))}function u(a,b){a.addEventListener(b,function(a){console.log(b,a)},!1)}function v(a,b){for(var c=0,d=a.length;d>c;c++)u(a[c],b)}function w(a,b){for(var c=0,d=b.length;d>c;c++)u(a,b[c])}function x(a,b){for(var c=0,d=a.length;d>c;c++)w(a[c],b)}function y(){w(a,["scroll","resize"]);var b=document.querySelectorAll("a");b.length&&v(b,"click");var c=document.querySelectorAll("input"),d=document.querySelectorAll("textarea");c.length&&x(c,["input","focus"]),d.length&&x(d,["input","focus"])}a.__synctest={};var b={},c=0,d="synccommand_"+(new Date).getTime(),e=[{ele:["window","document"],type:["DOMContentLoaded","load"]}],f="ws://{{ origin }}",g=new WebSocket(f);g.onopen=function(a){y(),console.log("[synctest start success]")},g.onclose=function(a){console.log("[synctest closed please check the server or refresh this page]")},g.onmessage=function(a){s(p(a.data))},g.onerror=function(a){console.log("[synctest closed please check the server or refresh this page]")},i.prototype={add:function(a){if(h(a))this.list.push(a);else if("[object Array]"===Object.prototype.toString.call(a))for(var b=0,c=a.length;c>b;b++)arguments.callee.call(this,a[b]);return this},fireWith:function(a,b){for(var c=this.list,d=0;d<c.length;d++)c[d].apply(a,b.slice?b.slice():b);return this},fire:function(){return this.fireWith(this,arguments),this}};var o=n(function(a,b){r(q(a,b))},150,200),t=EventTarget.prototype.addEventListener;a.addEventListener=EventTarget.prototype.addEventListener=function(a,e,f){var g=this;g[d]||(g[d]=++c),((b[c]||(b[c]={}))[a]||(b[c][a]=new i)).add(function(a){e.call(g,a)});var h=function(a){"scroll2"===a.type?o(this,a):r(q(this,a)),e.call(this,a),a.preventDefault()};t.call(g,a,h,f)}}(window);